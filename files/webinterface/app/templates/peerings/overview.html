{% extends "base.html" %}
{% load apptags %}

{% block main %}
    <div class="container">

      <h1>Peerings</h1>
      <p>Verwalten von Peerings (verschl√ºsselten Direktverbindungen zu anderen cjdns-Benutzern)</p>

      <legend>Verbindung zu anderen</legend>

{% if peerings %}
    <table class="table table-hover table-striped table-bordered">
        <thead>
          <tr>
            <th>Peering-Adresse</th>
            <th>Beschreibung</th>
          </tr>
        </thead>
        <tbody>
        {% for peering in peerings %}
        <tr>
            <td><a href="{% url app.views.peerings_edit peering.pk %}">{{ peering.address }}</a></td>
            <td>{{ peering.description }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
{% endif %}

<a href="/peerings/new/" class="btn btn-primary">Neues Peering</a>

<form method="post" class="form-horizontal">
{% csrf_token %}
<fieldset>

<legend>Eingehende Peerings</legend>

<div class="control-group">
  <label class="control-label" for="allow_peering">Peering erlauben</label>
  <div class="controls">
{% if allow_peering == '1' %}
    <button id="allow_peering" name="allow_peering" class="btn btn-success" value="1">Aktiviert</button>
{% else %}
    <button id="allow_peering" name="allow_peering" class="btn btn-inverse" value="1">Deaktiviert</button>
{% endif %}
  </div>
</div>

{% if allow_peering == '1' %}

<div class="control-group">
  <label class="control-label" for="peering_port">Port</label>
  <div class="controls">
    <input id="peering_port" name="peering_port" type="text" placeholder="47526" class="input-xlarge" value="{{ peering_port|default_if_none:'' }}">
  </div>
</div>

<div class="control-group">
  <label class="control-label" for="peering_password">Passwort</label>
  <div class="controls">
    <input id="peering_password" name="peering_password" type="text" placeholder="Password" class="input-xlarge" value="{{ peering_password|default_if_none:'' }}">
  </div>
</div>

<div class="control-group">
  <label class="control-label" for="save_peeringinfo"></label>
  <div class="controls">
    <button id="save_peeringinfo" name="save_peeringinfo" class="btn btn-primary" value="1">Speichern</button>
  </div>
</div>

{% if peering_port and peering_password %}

<div class="control-group">
  <label class="control-label" for="peeringinfo">Peering Info</label>
  <div class="controls">
    <input id="peeringinfo" name="peeringinfo" type="text" placeholder="" class="input-xlarge" value='"your.external.ip.goes.here:{{ peering_port }}":{"password":"{{ peering_password }}","publicKey":"{{ public_key }}"}'>
    <p class="help-block">Gib deiner Gegenstelle diese Informationen!</p>
  </div>
</div>

{% endif %}
{% endif %}

</fieldset>
</form>

<form method="post" class="form-horizontal">
{% csrf_token %}
<fieldset>

<legend>Autopeering</legend>

<div class="control-group">
  <label class="control-label" for="autopeering">Automatisch zu anderen cjdns-Knoten im gleichen Netzwerk verbinden</label>
  <div class="controls">
{% if autopeering == '1' %}
    <button id="autopeering" name="autopeering" class="btn btn-success" value="1">Aktiviert</button>
{% else %}
    <button id="autopeering" name="autopeering" class="btn btn-inverse" value="1">Deaktiviert</button>
{% endif %}
  </div>
</div>

</fieldset>
</form>

    </div> <!-- /container -->
{% endblock %}
